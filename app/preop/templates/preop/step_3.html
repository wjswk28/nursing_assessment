{% extends "preop/step_base.html" %}
{% set hide_nav = True %}
{% set title = "ê¸°ì €ì§ˆí™˜ ë° ìƒíƒœ í™•ì¸" %}

{% block form_fields %}
<div class="space-y-4">

    {% set items = [
        (1, "ê³ í˜ˆì••", "htn", "ë³µìš©ì•½ ë˜ëŠ” í˜ˆì•• ìˆ˜ì¹˜ë¥¼ ì…ë ¥í•˜ì„¸ìš”", False),
        (2, "ì‹¬ì¥ì§ˆí™˜", "heart", "ì–´ë–¤ ì‹¬ì¥ì§ˆí™˜ì¸ì§€ ì…ë ¥í•˜ì„¸ìš”", True),
        (3, "ë‹¹ë‡¨", "dm", "ë³µìš©ì•½ ë˜ëŠ” ì¸ìŠë¦° ì—¬ë¶€ë¥¼ ì…ë ¥í•˜ì„¸ìš”", False),
        (4, "ë‡Œì¡¸ì¤‘", "stroke", "ì–´ë–¤ ì§ˆí™˜ì¸ì§€ ì…ë ¥í•˜ì„¸ìš”", True),
        (5, "ì²œì‹", "asthma", "í˜¸í¡ê¸°ë¥¼ ì‚¬ìš©í•˜ë‚˜ìš”?", True),
        (6, "ê°‘ìƒì„  ì§ˆí™˜", "thyroid", "ì•½ì„ ë³µìš© ì¤‘ì¸ê°€ìš”?", True),
        (7, "ìœ„ì¥ ì§ˆí™˜", "gi", "ì–´ë–¤ ì§ˆí™˜ì¸ì§€ ì…ë ¥í•˜ì„¸ìš”", True),
        (8, "ê°„ì—¼", "hepatitis", "A/B/Cí˜• ì¤‘ ì–´ëŠ íƒ€ì…ì¸ê°€ìš”?", True),
        (9, "ê²°í•µ", "tb", "ì¹˜ë£Œ ì—¬ë¶€ ë° ì‹œê¸° ì‘ì„±", True),
        (10, "ë¥˜ë§ˆí‹°ìŠ¤ ê´€ì ˆì—¼", "ra", "ë³µìš©ì•½ ë˜ëŠ” ì¦ìƒ ì‘ì„±", False),
        (11, "ìˆ˜ìˆ ë¶€ìœ„ ìƒì²˜", "wound", "ìƒì²˜ì˜ ìœ„ì¹˜ì™€ ìƒíƒœë¥¼ ì…ë ¥í•˜ì„¸ìš”", True)
    ] %}

    {% for num, label, field, ph, need_desc in items %}
    <div class="disease-group">
        <label class="font-semibold text-sky-700">{{ num }}. {{ label }}</label>

        <div class="flex items-center gap-6 mt-2">
            <label><input type="radio" name="{{ field }}" value="ë¬´" {% if saved[field]=="ë¬´" %}checked{% endif %}> ë¬´</label>
            <label><input type="radio" name="{{ field }}" value="ìœ " {% if saved[field]=="ìœ " %}checked{% endif %}> ìœ </label>
        </div>

        {% if need_desc %}
            <input name="{{ field }}_desc"
                class="w-full border rounded p-2 mt-2 {% if saved[field] != 'ìœ ' %}hidden{% endif %}"
                value="{{ saved[field ~ '_desc'] or '' }}"
                data-placeholder="{{ ph }}"
                placeholder="{{ ph }}">
        {% endif %}
    </div>
    {% endfor %}
</div>

<script>
document.addEventListener("DOMContentLoaded", () => {
    document.querySelectorAll(".disease-group").forEach(g => {
        const yes = g.querySelector("input[value='ìœ ']");
        const no  = g.querySelector("input[value='ë¬´']");
        const box = g.querySelector("input[name$='_desc']");

        // ğŸ”¥ ì…ë ¥ì¹¸ ì—†ëŠ” í•­ëª©ì€ ê·¸ëƒ¥ skip
        if (!box) return;

        yes.addEventListener("change", () => {
            box.classList.remove("hidden");
            box.placeholder = box.dataset.placeholder; 
        });

        no.addEventListener("change", () => {
            box.classList.add("hidden");
            box.value = "";
        });
    });
});
</script>

{% endblock %}
